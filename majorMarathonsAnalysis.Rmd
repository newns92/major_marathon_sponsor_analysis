---
title: "Analysis"
output: html_document
---

```{r,warning=F,message=F,echo=F}
library(tidyverse) # data manipulation
library(ggplot2) # plotting
library(RColorBrewer) # new ggplot colors
library(kableExtra) # "pretty" tables
library(scales) # reversing time y-axis values (https://groups.google.com/forum/#!topic/ggplot2/qrcvqy6TdzI)

marathons <- read_rds('majorMarathons.Rda')
#glimpse(marathons)
```

In wake of this year's Boston and London marathons (and their almost polar opposite conditions), there certainly was a lot of press over some historic wins:
 
 * Desi Linden becoming the first American woman to win Boston since 1985
 * The "Citizen Runner" Yuki Kawauchi winning his first marathon major (also the first Japanese man in to win Boston in 31 years)
 * Eliud Kipchoge further cementing himself as (in my opinion) the greatest marathoner ever, winning his 8th straight marathon, and his 9th out of a total of 10 marathons (It's also important to note his only 2nd place was behind what ended up being a world record time)
 * Vivian Cheruiyot took the women's victory in London, taking advantage of the faltering of other elites such as Mary Keitany and Tirunesh Dibaba who were gunning for Paula Radcliffe's women's world record

Everything seems to have settled down a bit for the spring marathon season, but I thought it'd be fun to do a cursory analysis of the winners of the six current World Marathon Majors so far.

## What are the World Marathon Majors?

The [World Marathon Majors (WMM)](https://www.worldmarathonmajors.com/) is a collection of six annual marathons: Tokyo, New York, Boston, London, Berlin, andd Chicago. And, in designated years, they also include the World Championship (held every 2 years by the IAAF) and the Olympic Marathons. The races are run as a series and the male and female athlete who score the most points from the qualifying races are crowned the champions of the series ("most points" is defined as the sum of points from a max of two of the qualifying races). For us non-elites, you can qualify as a **Six Star Finisher**, wherein after successfully completing all six of the WMM's, you can recieve an official certificate and Six Star Finisher Medal.

### EDA

After scraping Wikipedia for the past winners of the races and cleaning up the data (including having to manually add the female winner for London 2018, Vivian Cheruiyot, since it still wasn't added over a week later, because Wikipedia?), I had a [nice data file](https://github.com/newns92/major_marathon_sponsor_analysis/blob/master/marathons.R) consisting of, for each race, the marathon, the winner, the year, the winner's gender, and the winner's time. For a quick first plot to look, I decided on the top 10 countries in terms of WMM wins.

```{r wins by country, echo=F, message=F, warning=F, fig.align='center'}
marathons %>%
  filter(!is.na(country)) %>%
  group_by(country)%>%
  summarise(count = n()) %>%
  arrange(desc(count)) %>%
  top_n(n = 10) %>%
  ggplot(aes(country,count)) + 
    geom_bar(stat="identity",colour="Black",fill="Blue") +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
    xlab("Country") + 
    ylab("Wins") +
    ggtitle("Top 10 Countries in Total World Major Marathon Wins")
```    
  
The general consensus that Eastern Africa (i.e. Kenya and Ethiopa) is dominating long distance running is clearly backed up in this plot, and we see the countries with the next most wins being the United States, Germany, UK, and Japan. It's pretty easy infer a guess as to why, after Kenya and Ethiopia, these three countries have the most victories. Five of the six major marathons take place in these countries, which most likely results in a larger amount of runners from the host country participating, relative to other countries, providing said home countries with more chances of producing the victor. But when did this domination by the East Africans begin?

```{r, warning=F,message=F,echo=F, fig.align='center'}
marathons %>% 
  group_by(country, year) %>%
  summarise(value = n()) %>%
  filter(country %in% c("Kenya","Norway","United States","United Kingdom","Germany","Ethiopia","Japan","Canada")) %>%
  ggplot(aes(x=year,color=country)) +
    stat_bin(data=subset(marathons,country=="Kenya"),aes(y=cumsum(..count..)),geom="line",lwd=1.05)+
    stat_bin(data=subset(marathons,country=="Norway"),aes(y=cumsum(..count..)),geom="line",lwd=1.05)+
    stat_bin(data=subset(marathons,country=="Germany"),aes(y=cumsum(..count..)),geom="line",lwd=1.05)+
    stat_bin(data=subset(marathons,country=="Ethiopia"),aes(y=cumsum(..count..)),geom="line",lwd=1.05)+
    stat_bin(data=subset(marathons,country=="United Kingdom"),aes(y=cumsum(..count..)),geom="line",lwd=1.05)+
    stat_bin(data=subset(marathons,country=="Japan"),aes(y=cumsum(..count..)),geom="line",lwd=1.05)+
    stat_bin(data=subset(marathons,country=="United States"),aes(y=cumsum(..count..)),geom="line",lwd=1.05) +
    stat_bin(data=subset(marathons,country=="Canada"),aes(y=cumsum(..count..)),geom="line",lwd=1.05) +
    scale_color_brewer(palette = "Dark2") +
   # geom_point(aes(1967,37),size=3,color="purple") +  # bowerman = jogging
    geom_point(aes(1971,49),size=3,color="#7e7e7e") +
    geom_text(aes(x=1954, label="Frank Shorter (1972)", y=50), colour="#7e7e7e", angle=0, size=3) +
    geom_point(aes(1983,90),size=3,color="#7e7e7e") +
    geom_text(aes(x=1967, label="Joan Benoit (1984)", y=90), colour="#7e7e7e", angle=0, size=3) +
    coord_cartesian(ylim=c(0,150),xlim=c(1890,2018)) +   
    scale_x_continuous(breaks=seq(1900, 2020, 20)) +   
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
    xlab("Year") +
    ylab("Cumulative Wins") +
    ggtitle("Cumulative Major Marathon Wins by Country Over Time (1897-2018)")
```

Noting the *incredibly important caveat* that Boston was the only marathon in the current WMM's that existed from its initial running in 1897 until the first running of the New York City Marathon in 1970, I believe it's safe to assume the fact that international travel was not as accessible and common in this time period is why only individuals from countries in close proximity to these races (i.e. US and Canada) saw their counts climb. This makes this chart pretty useless unless we narrow down on the time period that we are looking at. 

But, before leaving this chart completely, we can note that German and UK wins started picking up soon after the first couple of their respective marathons, with Berlin starting in 1974 and London in 1981, respectively. We can also note that the number of US winners starts to climb much faster throughout the 1970's, thanks to the establishment of the NYC and Chicago marathons in this decade, along with the inclusion of women in the Boston marathon. The start of this spike also just barely predates Frank Shorter's gold medal at the 1972 Olympics, which is credidted as starting the running boom of the 1970's in the US, which is also said to have culminated with Joan Benoit Samuelson's gold medal in the 1984 Olympics.

But now, onto the limited time period:

```{r, warning=F,message=F,echo=F, fig.align='center'}
marathons %>% 
  group_by(country, year) %>%
  summarise(value = n()) %>%
  #mutate(csum = cumsum(value)) %>%
  filter(country %in% c("Kenya","Norway","United States","United Kingdom","Germany","Ethiopia","Japan","Canada")) %>%
  ggplot(aes(x=year,color=country)) +
    stat_bin(data=subset(marathons,country=="Kenya"),aes(y=cumsum(..count..)),geom="line",lwd=1.05)+
    stat_bin(data=subset(marathons,country=="Norway"),aes(y=cumsum(..count..)),geom="line",lwd=1.05)+
    stat_bin(data=subset(marathons,country=="Germany"),aes(y=cumsum(..count..)),geom="line",lwd=1.05)+
    stat_bin(data=subset(marathons,country=="Ethiopia"),aes(y=cumsum(..count..)),geom="line",lwd=1.05)+
    stat_bin(data=subset(marathons,country=="United Kingdom"),aes(y=cumsum(..count..)),geom="line",lwd=1.05)+
    stat_bin(data=subset(marathons,country=="Japan"),aes(y=cumsum(..count..)),geom="line",lwd=1.05)+
    stat_bin(data=subset(marathons,country=="United States"),aes(y=cumsum(..count..)),geom="line",lwd=1.05) +
    stat_bin(data=subset(marathons,country=="Canada"),aes(y=cumsum(..count..)),geom="line",lwd=1.05) +
    scale_color_brewer(palette = "Dark2") +
    geom_point(aes(1984,90),size=3,color="#7e7e7e") +
    geom_text(aes(x=1978, label="Joan Benoit ('84)", y=95), colour="#7e7e7e", angle=0, size=3) +
    geom_point(aes(2008,35),size=3,color="brown") +
    geom_text(aes(x=2006,y=43,label="Last UK Win ('08)"), colour="brown", angle=0, size=3) + 
    geom_point(aes(1983,2),size=3,color="green") +
    geom_text(aes(x=1983,y=-4,label="First Kenya Win"), colour="green", angle=0, size=3) + 
    coord_cartesian(xlim=c(1970,2018),ylim=c(0,150)) + 
  geom_vline(xintercept=2017) + 
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
    xlab("Year") +
    ylab("Cumulative Wins") +
    ggtitle("Cumulative Major Marathon Wins by Country Over Time (1970-2018)")
```

Here, we see that the first Kenyan win was in 1983, but the country's rise in marathon victories did not kick-start until the mid-1990's. Ethiopia's win count started a bit later, with their first victory in 1989 and their uptick in victories starting in early 2000's. We also see some plateaus from the other top countries, with the UK being in a drought since 2008, after 7 wins from Radcliffe over a 6 year span that started in 2002. Germany has just 2 wins in past 20 years, with both of them also occuring in 2008.

Next, I decided to look at who has won the most WMM's.

```{r, warning=F,message=F,echo=F, fig.align='center'}
 marathons %>%
  filter(!is.na(country)) %>%
  group_by(winner,country,gender)%>%
  summarise(count = n()) %>%
  arrange(desc(count)) %>%
  head(10) %>%
  kable()
```

We can see that Grete Waitz (the first woman to run the marathon under 2:30:00, in NYC in 1979) is alone at the top of leaderboard, and who, along with fellow dominant Norwegian Ingrid Kristiansen, make up the top 2 women, and 2 of the top 3 runners overall, in terms of WMM wins. It also appears that although Kenya has many WMM wins in aggregate, the total must be quite spread out, as we do not see a Kenyan runner in the top 10 total wins until the tie between Catherine Nderebe, Kipchoge, and Keitany. Kipchoge and Keitany are still actively racing, however, and it's never a safe bet to count them out of any race. Let's take the top 5 runners here and see where their WMM wins occured.

```{r, warning=F,message=F,echo=F, fig.align='center'}
marathons %>%
  filter(winner %in% c("Bill Rodgers","Clarence DeMar","Grete Waitz","Ingrid Kristiansen","Paula Radcliffe","Uta Pippig")) %>%
  group_by(winner,marathon) %>%
  summarize(count = n()) %>%
  kable()
```

Here we note the dominance of Grete Waitz at NYC with *nine* wins. The fact that every single marathon major win by Clarence DeMar was in Boston isn't that intersting, as it was the only WMM around in during his career in the early 20th century (seven marathon wins is still impressive, nonehteless). Meanwhile, Bill "Boston Billy" Rodgers actually split his WMM wins between NYC and Boston, and Paula Radcliffe split six of her seven wins between home nation of London (where she also set the current women's world record) and NYC.
```{r, eval=F, echo=F}
# future = US in international?
```

Going back to that initial wins-by-country bar chart, we can split it out by gender, filtered down to the years in which both men and women competed and to having more than 5 wins for either gender in order to get a clearer picture of the distribution.

```{r warning=F, message=F, echo=F, fig.align='center'}
marathons %>%
  filter(!is.na(country),
         year>=1981) %>%
  group_by(country,gender) %>%
  summarise(count = n()) %>%
  arrange(desc(count)) %>%
  filter(count>5) %>%
  ggplot(aes(country,count)) + 
    geom_bar(aes(fill=gender),stat="identity",colour="Black",position="dodge") +
    scale_fill_manual("Gender", values = c("Male" = "blue", "Female" = "Red")) +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
    xlab("Country") + 
    ylab("Frequency") +
    ggtitle("Total Major Marathon Wins by Country by Gender")
```  

So, Kenya clearly still reigns supreme, having the most male and females champions, while the female runners of Ethiopia, as well those in Japan, have performed better than their male counterparts. Many countries have had female winners only (see again the dominance of Waitz and Kristiansen in Norway's count, Uta Pippig's in Germany, and Rosa Mota for Portugal), while Mexico and Brazil are the only countries with at least 5 wins that were all males. Then we have the UK and US being split in the wins by gender.

Next, we can look at some visualizations concerning the winning times.

### Time

The first thing I wanted to look at was the trend of the fastest winning times per year over the entire time period of the dataset (I chose fastest winning times because in a plot of all time values, the sudden inclusion of women in the early 1970's produced an incredible wild-looking right-hand side of the plot):


```{r, eval=F, warning=F,message=F,echo=F, fig.align='center'}
marathons %>%
  filter(!is.na(time)) %>%
 # left_join(marathons %>%
   # group_by(year) %>%
   # summarize(minTime = min(time,na.rm=T)) %>%
   #arrange(year),by = "year") %>%
  ggplot(aes(year,time)) + 
  geom_line() + 
  geom_smooth() +
  coord_cartesian(ylim=c(as.POSIXct(paste(Sys.Date(),"02:00:00")),as.POSIXct(paste(Sys.Date(),"03:30:00")))) + 
  theme_bw()
```

```{r, eval=F, warning=F,message=F,echo=F, fig.align='center'}
marathons %>%
  filter(!is.na(time)) %>%
  left_join(marathons %>%
    group_by(year) %>%
    summarize(minTime = min(time,na.rm=T)) %>%
    arrange(year),by = "year") %>%
  ggplot(aes(year,minTime)) + 
  geom_line() + 
  geom_smooth() +
  coord_cartesian(ylim=c(as.POSIXct(paste(Sys.Date(),"02:00:00")),as.POSIXct(paste(Sys.Date(),"03:00:00")))) + 
  theme_bw()
```

We can see there was a mild, slow-but-steady decline over the years until the mid-1980's wherein the decrease starts to slow, suggesting that there are only marginal gains to come for the fastest winning WMM times in the future. This line plot can be split out by marathon as well.

```{r, warning=F,message=F,echo=F, fig.align='center'}
marathons %>%
  filter(!is.na(time)) %>%
  ggplot(aes(year,time,color=marathon)) + 
    geom_smooth(se=F) + 
    theme_bw() + 
    facet_wrap(~marathon, scales = "free_x")# +
    #coord_cartesian(xlim=c(2007,2018),
    #                ylim = c(as.POSIXct(paste(Sys.Date(),"02:00:00")),as.POSIXct(paste(Sys.Date(),"02:25:00"))))
```

e could suggest that the low initial time for the Tokys marathon is due to its relatively recent estlaishment in an era of fast marathons, but the fact that London start ~20 yeras earliers doesn't give that theory much credence. London winning times also appears to have gotten slower in the 1st 15 years of the race before starting a steady decline to a now current pleteau. We also see and increasible drop in winning times in Berlin, while Chicago and NYC have a similar but less sever pattern. Boston has quite the variability with a slight upticks in 60's and and in the curren ttime periuod. A better look at this could be to see these trends  since inception of Tokyo: 

```{r, warning=F,message=F,echo=F, fig.align='center'}
marathons %>%
  filter(!is.na(time)) %>%
  ggplot(aes(year,time,color=marathon)) + 
    geom_smooth(se=F) + 
    theme_bw() + 
    facet_wrap(~marathon) +
    coord_cartesian(xlim=c(2007,2018),
                    ylim = c(as.POSIXct(paste(Sys.Date(),"02:00:00")),as.POSIXct(paste(Sys.Date(),"02:25:00"))))
```

The majority of winning WMM times are quite straight, with the exception of The decrease in TOkyo (possibly as more top marathoners started to take part in the race) and the *increase* in Boston times over the past decade. London quite the same, BARELY going down, Berling slowly going down, NYC + Chicaco v. similar in keeping steay with BARELY increase, Bostong acutally getting lsower, TOkyo goign down faster in this smaller window, maybe due to it's "newness" just starting to attract the top talent to race



We can also split this out by gender and limiting to years when both men and women competed.

```{r, warning=F,message=F,echo=F, fig.align='center'}
marathons %>%
  filter(!is.na(time)) %>%
  left_join(marathons %>%
              group_by(year,gender) %>%
              summarize(minTime = min(time,na.rm=T)) %>%
              arrange(year),by = c("year","gender")) %>%
  select(year,gender,minTime) %>%
  filter(!is.na(gender),year>=1966) %>%
  ggplot(aes(year,minTime)) + 
    geom_line(aes(colour=gender)) +
    scale_color_manual("Gender", values = c("Male" = "blue", "Female" = "Red")) + 
    facet_grid(~gender) +
    guides(fill=F) +
    theme_bw() + 
    xlab("Year") + 
    ylab("Fastest Winning Time (HH:MM)")
```

It appears the winning women to started out quite slow relative to their current times, and there was a remarkably quick drop in fastest winning times between 1970 and 1980 before returning to a pattern of a slow decline resembling the men's plot. We can break out all winning times out by winning country to see how those distributions come out.

```{r, warning=F, message=F, echo=F, fig.align='center'}
#c_trans <- function(a, b, breaks = b$breaks, format = b$format) {
#  a <- as.trans(a)
 # b <- as.trans(b)

 # name <- paste(a$name, b$name, sep = "-")

 # trans <- function(x) a$trans(b$trans(x))
 # inv <- function(x) b$inverse(a$inverse(x))

 # trans_new(name, trans, inv, breaks, format)
#}

#rev_date <- c_trans("reverse", "time")

marathons %>%
  filter(country %in% c("Kenya","Norway","United States","United Kingdom","Germany","Ethiopia","Japan","Canada")) %>%
  ggplot(aes(country,time)) + 
    #geom_jitter(aes(color = country),alpha=.6) +
    geom_boxplot(aes(fill = country),alpha=.5,outlier.colour = "black",varwidth = T) +
    scale_fill_brewer(palette = "Dark2") +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
    xlab("Country") + 
    ylab("Winning Time (HH:MM)") +
    ggtitle("Total Major Marathon time by Country") + 
    guides(fill=F) 
    #+ scale_y_continuous(trans = rev_date)
```

I'd say the larger relative variability in US is understandable when accounting for the fact that many of these winners won at some point during long history of Boston, many occuring before marathon times started significantly to drop. The US has the slowest outliers, ignoring the one German outlier. Germany's wide variance is something to note, for me at least. It is my understanding that runners go to Chicago or Berlin for time, as they are said to be flatter and therefore faster courses. I would think more Germans would've been running here, and therefore would've had quicker times with not too much variabilitiy, but weather could be a factor here. We can see Norway and Canada winners both have very little variabliity in winning times, and coincidentally both have one slow and one fast outlier, albeit with with lower sample sizes than Kenya, Ethiopia, and the US. Norway also appears to be a bit skewed, with its median winnign time being more towards the 3rd quartile. But, again, Kenya's contiuest to perform better than other countries, having the fastest median win time (again, with a skew). Then, while the UK and Japan both seem to have faster winning times than Ehtiopoa, Ethipoua in fact wins more races. This isn't so surprising since many major marathons are run with the tactical intent to win the race and not so much with a focus on having a very fast time. Speaking of which, let's look at the times with respect to the races themselves.


```{r, warning=F,message=F,echo=F, fig.align='center'}
medianTime <- median(marathons$time,na.rm=T)

marathons %>%
  filter(!is.na(time)) %>%
  ggplot(aes(marathon,time)) + 
    geom_boxplot(aes(fill = marathon),alpha=.4, outlier.colour = "black",varwidth = T) +   
    coord_cartesian(ylim=c(as.POSIXct(paste(Sys.Date(),"02:00:00")),as.POSIXct(paste(Sys.Date(),"03:35:00")))) + 
    guides(fill=F) + 
    theme_bw() + 
    xlab("Marathon") + 
    ylab("Winning Time (HH:MM)") +
    ggtitle("Total Major Marathon time by Country")# + 
    #+ scale_y_continuous(trans = rev_date)
```

So, Boston and NYC appear the be the slowest of the WMM's, with the slowerst third quartile time and slowerst median times. This makes sense as they are both known for their tough hills. The "fast" marathons in Chicago and Berline seem almost identicat, with Berlin have a coupel more slower outleirs. And, recalling my oirignla assumaption that Beling and Chicahog were faster, it looks like London is actually the race to run if one is looking for a faster time, with the lowest median time and the fact that this median skews towards the first quartile. Overall, the variability among marathons seems quite even, as we can see from the heights of each box **all between 2:10-2:30***. From this plot, Tokyo also looks to have quite a normal distribtion, but that remains to be confirmed via a histogram or density plot, which we can move onto now 


```{r, eval=F, warning=F,message=F,echo=F, fig.align='center'}
#marathons %>%
#  filter(!is.na(time)) %>%
#  ggplot(aes(marathon,time)) + 
#    geom_boxplot(aes(fill = marathon),alpha=.4, outlier.shape = NA,varwidth = T) +   
#    coord_cartesian(ylim=c(as.POSIXct(paste(Sys.Date(),"02:00:00")),as.POSIXct(paste(Sys.Date(),"03:00:00")))) + 
#    guides(fill=F) + 
#    theme_bw() 
    #+ scale_y_continuous(trans = rev_date)
```

```{r, warning=F,message=F,echo=F, fig.align='center'}
marathons %>%
  filter(!is.na(time)) %>%
  ggplot(aes(time)) + 
  geom_histogram(bins=100,na.rm=T,fill="green") + 
  #coord_cartesian(xlim=c(as.POSIXct(paste(Sys.Date(),"02:00:00")),as.POSIXct(paste(Sys.Date(),"03:00:00")))) + 
  theme_bw() + 
  xlab("Winning Time (HH:MM)") + 
  ylab("Frequency") +
  ggtitle("Total Major Marathon time by Country")
```

The bimodal nature of the histogram is apparant, and is almost certainly due to differeneces in times by gender. We can see that one peak of winning times centered in the mid 2:20's, most likely for the women, and the other peak centered in the lower 2:10's, most likely for the men.

```{r, warning=F,message=F,echo=F, fig.align='center'}
marathons %>%
  filter(!is.na(time)) %>%
  ggplot(aes(time)) + 
  geom_density(aes(group=gender,fill=gender),alpha=.4) + 
  scale_fill_manual("Gender", values = c("Male" = "blue", "Female" = "Red")) + 
  theme_bw() + 
  xlab("Winning Time (HH:MM)") + 
  ylab("Density") +
  ggtitle("Total Major Marathon time by Country")
```

Indeed this density confirms my pretty obvious assumption, we further higlights the large right-skew of both distributions. We can split these density plots out by marathon, both overall and also by gender.

```{r, warning=F,message=F,echo=F, fig.align='center'}
marathons %>%
  filter(!is.na(time)) %>%
  ggplot() + 
    stat_density(aes(x=time,y=..scaled..,fill=marathon),color="black") + 
    scale_fill_brewer(palette = "Dark2") +
    facet_wrap(~marathon) + 
    guides(fill=F) + 
    theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
    theme_bw() + 
    xlab("Winning Time (HH:MM)") + 
    ylab("Density") +
    ggtitle("Density of Winning Times by Marathon")
```

For some countries, the bimodal nature is more pronounced, scuh as in London and NYC, with NYC's peaks looking very similar, with a noticable right-tail, relatively speaking. Berlin and Chicago have less pronounced peaks, and we can see London and Tokyo have much larger densities in the lower-two hour range in contrast to Boston, who is the only marathon wherein the slower mode has a noticably larger density in comparison to the faster mode. This info can also be split out by gender.

```{r, warning=F,message=F,echo=F, fig.align='center'}
marathons %>%
  filter(!is.na(time)) %>%
  ggplot() + 
    geom_density(aes(x=time,y=..scaled..,group=gender,fill=gender),alpha=.4) + 
    scale_fill_manual("Gender", values = c("Male" = "blue", "Female" = "Red")) +
    facet_wrap(~marathon) + 
    #guides(fill=F) + 
    theme_bw() + 
    theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
    xlab("Winning Time (HH:MM)") + 
    ylab("Density") +
    ggtitle("Densities of Winning Times by Gender by Marathon")  
```
It seems that Boston's long history has caused a bimodal distribution of winning male times, not solely overall times. Also, recalling the fact that the boxplots for London and Tokyo were the 2 marathons with no outliers, we can see that they are the only two density plot pairs here without a pronounced right tail. It appears that NYC has two very non-variable modes, along with multiple very small bumps going down the x-axis to the right. The males in Chicago, Berlin, London, and Tokyo all have skinnier densities, indicating less variety in winning times for males in these marathons in comparison to the females, whose densities are quite wider. For another picture, we can, again, filter down to just years where both men and women competed.

```{r, warning=F,message=F,echo=F, fig.align='center'}
marathons %>%
  filter(!is.na(country),
         year>=1981) %>%
  ggplot() + 
    geom_density(aes(x=time,y=..scaled..,group=gender,fill=gender),alpha=.4) + 
    scale_fill_manual("Gender", values = c("Male" = "blue", "Female" = "Red")) +
    facet_wrap(~marathon) + 
    theme_bw() + 
    theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

Now *Boston* and NYC have the least variable distributions fo rboth genders, and only Chicago and Berling (and arguable Japan) still have that right tail for the women's disrtibution. tight densities around similar times, Tokyo males quite consistent, Berin, CHI, Londong quite similar, 
